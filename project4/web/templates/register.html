<h3>Register</h3>
<form id="form-in-modal" method="post">
    <span class="label-form-modal">Email</span>
    <input id="email" type="text" name="email" value="sdfsdf@sdfsd.sd" class="form-in-modal check-blank">
    <span class="label-form-modal">Password</span>
    <input id="password" type="password" name="password" value="" class="form-in-modal check-blank">
    <span class="label-form-modal">Re-enter Password</span>
    <input id="re-password" type="password" name="re-password" class="form-in-modal check-blank">
    <span class="label-form-modal">Name</span>
    <input id="name" type="text" name="name" class="form-in-modal">
    <span class="label-form-modal">Gender</span>
    <div class="form-in-modal">
        <label>
            <input id="male" checked value="male" name="gender" type="radio">
            <i class="far fa-male"></i> <span>Male</span>
        </label>
        <label style="margin-left: 18px;">
            <input id="female" value="female" name="gender" type="radio">
            <i class="far fa-female"></i> <span>Female</span>
        </label>
    </div>
    <span class="label-form-modal">Address</span>
    <input id="address" type="text" name="address" class="form-in-modal">
    <span class="label-form-modal">Phone</span>
    <input id="phone" type="text" name="phone" class="form-in-modal">
    <button class="db-tac" id="register-button" type="submit">REGISTER</button>
    <div class="db-tac"><span>You already have account?</span> <a class="modal-login" href="">Login</a></div>
</form>
<script>
    var error = 0;
    var  gender = $('input[type=radio][name=gender]').val();
    $('input[type=radio][name=gender]').change(function(){
        gender = $(this).val();
    });
    
   function validatePhone(){
       var phone = $("#phone").val();
       $("#phone").next('.error-form').remove();
       if(phone == ""){
           $("#phone").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
           error++;
       }
   }
   function validateName(){
        var name = $("#name").val();
        $("#name").next('.error-form').remove();
       if(name == ""){
           $("#name").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
           error++;
       }
   }
   function validateAddress(){
       var address = $("#address").val();
       $("#address").next('.error-form').remove();
       if(address == ""){
           $("#address").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
           error++;
       }
   }
   function validateInfo(){
       error = 0;
       validatePhone();
       validateName();
       validateAddress();
   }
   
   $("#name").focusin(function(){
       $(this).next('.error-form').remove();
   });
   $("#phone").focusin(function(){
       $(this).next('.error-form').remove();
   });
   $("#address").focusin(function(){
       $(this).next('.error-form').remove();
   });
   $("#name").focusout(function(){
       validateName();
   });
   $("#phone").focusout(function(){
       validatePhone();
   });
   $("#address").focusout(function(){
       validateAddress();
   });
   $("#email").focusout(function(){
       validateEmail($(this).val());
   });
   $("#password").focusout(function(){
       var pass = $(this).val();
       
       if(pass == "") {
            $("#password").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
            error++;
      } else if(pass.length<6 || pass.length>22){
           $(this).after("<span class=\"error-form\" style=\"color: red; \">Pass must have 6 to 22 character!</span>");
            error++;
       } else if(pass != $('#re-password').val()){
          $("#re-password").next('.error-form').remove(); 
            $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">Password not match!</span>");
            error++;
      } else{
          $("#re-password").next('.error-form').remove(); 
      }
   });
   $("#re-password").focusout(function(){
       var pass = $(this).val();
       if(pass == "") {
            $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
            error++;
      }else if(pass.length<6 || pass.length>22){
           $(this).after("<span class=\"error-form\" style=\"color: red; \">Pass must have 6 to 22 character!</span>");
            error++;
       }  else if(pass != $('#password').val()){
          $("#re-password").next('.error-form').remove(); 
            $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">Password not match!</span>");
            error++;
      }
   });
   $('.check-blank').focusin(function(){
      $(this).next('.error-form').remove(); 
   });
    $('#register-button').click(function() {
            event.preventDefault();
            $(".error-form").remove();
          var email=$("#email").val();
          var password=$("#password").val();
          var repassword=$("#re-password").val();
          var name=$("#name").val();
          var address=$("#address").val();
          var phone=$("#phone").val();
          error = 0;
          if(password == "") {
                $("#password").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
                error++;
          }
          if(repassword == "") {
                $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
                error++;
          }
          validateEmail(email);
          if(password != repassword){
                $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">Password not match!</span>");
                error++;
          } 
          validateInfo();
          
          if(error == 0){
                $.ajax({
                    type:"POST",
                   data:{"email":email,"password":password,"name":name,"address":address,"phone":phone,"gender":gender},
                   url: "http://localhost:8080/project4/register",
                   success: function(data) {
                       console.log("success");
                       location.reload();
                   },
                   error:function(){
                       console.log("error");
                   },
                });
            }
        });
    
    $('a.modal-login').click(function(event) {
        event.preventDefault();
        $(".modal-form").remove();
        $(".content").append("<div class=\"modal-form wow fadeInDownModal\"></div>");
        $(".modal-form").load("http://localhost:8080/project4/templates/login.html");
    });  
    
    function checkEmail(email) {
        var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(email);
      }
      
      function sosanhPass(){
           $('#re-password').next(".error-form").remove();
          var password=$("#password").val();
          var repassword=$("#re-password").val();
        if(password != "" && repassword != "" && password != repassword){
                $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">Password not match!</span>");
          } 
      }
      function validateEmail(email){
          if(email != ""){
                if(checkEmail(email)){
                  $.ajax({
                    type:"GET",
                    data:{"email":email},
                    url: "http://localhost:8080/project4/register",
                    error: function(){
                          $("#email").after("<span class=\"error-form\" style=\"color: red; \">Email is existed!</span>");
                          error++;
                      }
                  });
                } else{
                  $("#email").after("<span class=\"error-form\" style=\"color: red; \">Email is wrong format!</span>");
                  error++;
                }
          } else{
                $("#email").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
                error++;
          }
        }
      

</script>