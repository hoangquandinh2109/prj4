<h3>Register</h3>
<form id="form-in-modal" method="post" action="login">
    <span class="label-form-modal">Email</span>
    <input id="email" type="text" name="email" class="form-in-modal check-blank">
    <span class="label-form-modal">Password</span>
    <input id="password" type="password" name="password" class="form-in-modal check-blank">
    <span class="label-form-modal">Re-enter Password</span>
    <input id="re-password" type="password" name="re-password" class="form-in-modal check-blank">
    <span class="label-form-modal">Name</span>
    <input id="name" type="text" name="name" class="form-in-modal">
    <span class="label-form-modal">Address</span>
    <input id="address" type="text" name="address" class="form-in-modal">
    <span class="label-form-modal">Phone</span>
    <input id="phone" type="text" name="phone" class="form-in-modal">
    <button class="db-tac" id="register-button" type="submit">REGISTER</button>
    <div class="db-tac"><span>You already have account?</span> <a class="modal-login" href="">Login</a></div>
</form>
<script>
    var error = 0;
   $("#email").focusout(function(){
       validateEmail($(this).val());
   });
   $("#password").focusout(function(){
       var pass = $(this).val();
       
       if(pass == "") {
            $("#password").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
            error++;
      } else if(pass.length<7 || pass.length>22){
           $(this).after("<span class=\"error-form\" style=\"color: red; \">Pass must have 6 to 22 character!</span>");
            error++;
       } else if(pass != $('#re-password').val()){
          $("#re-password").next('.error-form').remove(); 
            $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">Password not match!</span>");
            error++;
      } else{
          $("#re-password").next('.error-form').remove(); 
      }
   });
   $("#re-password").focusout(function(){
       var pass = $(this).val();
       if(pass == "") {
            $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
            error++;
      }else if(pass.length<7 || pass.length>22){
           $(this).after("<span class=\"error-form\" style=\"color: red; \">Pass must have 6 to 22 character!</span>");
            error++;
       }  else if(pass != $('#password').val()){
          $("#re-password").next('.error-form').remove(); 
            $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">Password not match!</span>");
            error++;
      }
   });
   $('.check-blank').focusin(function(){
      $(this).next('.error-form').remove(); 
   });
    $('#register-button').click(function() {
            event.preventDefault();
            $(".error-form").remove();
          var email=$("#email").val();
          var password=$("#password").val();
          var repassword=$("#re-password").val();
          var name=$("#name").val();
          var address=$("#address").val();
          var phone=$("#phone").val();
          console.log(password+" va "+repassword);
          if(password == "") {
                $("#password").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
                error++;
          }
          if(repassword == "") {
                $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
                error++;
          }
          validateEmail(email);
          if(password != repassword){
                $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">Password not match!</span>");
                error++;
          } 
          console.log("error: "+error);
          if(error = 0){
              console.log("dk");
                $.ajax({
                    type:"POST",
                   data:{"email":email,"password":password,"name":name,"address":address,"phone":phone},
                   url: "register",
                   success: function(data) {
                       console.log("success");
                       location.reload();
                   },
                   error:function(){
                       console.log("error");
//                       $("#error2").text("Login unsuccessful!");
//                       $("#error2").show();
                   },
                });
            }
        });
    
    $('a.modal-login').click(function(event) {
        event.preventDefault();
        $(".modal-form").remove();
        $(".content").append("<div class=\"modal-form wow fadeInDownModal\"></div>");
        $(".modal-form").load("templates/login.html");
    });  
    
    function checkEmail(email) {
        var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(email);
      }
      
      function sosanhPass(){
           $('#re-password').next(".error-form").remove();
          var password=$("#password").val();
          var repassword=$("#re-password").val();
        if(password != "" && repassword != "" && password != repassword){
                $("#re-password").after("<span class=\"error-form\" style=\"color: red; \">Password not match!</span>");
          } 
      }
      function validateEmail(email){
          if(email != ""){
                if(checkEmail(email)){
                  $.ajax({
                    type:"GET",
                    data:{"email":email},
                    url: "register",
                    error: function(){
                          $("#email").after("<span class=\"error-form\" style=\"color: red; \">Email is existed!</span>");
                          error++;
                      }
                  });
                } else{
                  $("#email").after("<span class=\"error-form\" style=\"color: red; \">Email is wrong format!</span>");
                  error++;
                }
          } else{
                $("#email").after("<span class=\"error-form\" style=\"color: red; \">This filed cannot be blank!</span>");
                error++;
          }
        }
      

</script>